package com.codecool.rentsite.review;

import com.codecool.rentsite.reservation.Reservation;
import com.codecool.rentsite.user.User;
import org.hibernate.annotations.Any;
import org.hibernate.annotations.AnyMetaDef;
import org.hibernate.annotations.Cascade;
import org.hibernate.annotations.MetaValue;

import javax.persistence.*;

@Entity
public class Review {

    @Id
    @GeneratedValue(strategy = GenerationType.SEQUENCE)
    private int id;
    private String description;

    @ManyToOne
    private User author;

    @Any(metaColumn = @Column(name = "review_type"))
    @AnyMetaDef(idType = "long", metaType = "string",
            metaValues = {
                    @MetaValue(targetEntity = User.class, value = "user"),
                    @MetaValue(targetEntity = Reservation.class, value = "reservation")
            })
    @Cascade( { org.hibernate.annotations.CascadeType.ALL})
    @JoinColumn(name = "target_Id")
    private Review review;

    private int rate;
    public Review(String description, User author, Review reviewable) {
        this.description = description;
        this.author = author;
        this.review = reviewable;
        this.rate = 0;
    }

    public Review(){}

    public int getId() {
        return id;
    }

    public String getDescription() {
        return description;
    }

    public User getAuthor() {
        return author;
    }


    public int getRate() {
        return rate;
    }

    public void setId(int id) {
        this.id = id;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public void setAuthor(User author) {
        this.author = author;
    }

    public void setRate(int rate) {
        this.rate = rate;
    }

    public Review getReview() {
        return review;
    }

    public void setReview(Review review) {
        this.review = review;
    }
}
